<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover">
  <title>CityChainNFT</title>
  <link rel="stylesheet" href="styles.css?v=20251029_134457_222739_220608">
</head>
<body>
  <div id="app">
    <header class="topbar"><div class="title">Metropolis</div></header>

    <main class="content">
      <section id="tab-shop" class="tab" data-tab-pane="shop">
        <div class="stub">Здесь будет магазин.</div>
      </section>

      <!-- КАРТА → МЕНЮ РЕГИОНОВ -->
      <section id="tab-map" class="tab active" data-tab-pane="map">
        <div class="menu-wrap">
          <h2 class="menu-title">Регионы</h2>
          <div class="regions-grid" id="regions-grid"></div>
        </div>
      </section>

      <section id="tab-profile" class="tab" data-tab-pane="profile">
        <div class="stub">Профиль пользователя.</div>
      </section>
    </main>

    <!-- Нижний таббар -->
    <nav class="bottombar">
      <button id="tab-btn-shop" class="tabbtn" data-tab="shop" onclick="switchTabInline('shop')">Магазин</button>
      <button id="tab-btn-map" class="tabbtn" data-tab="map" onclick="switchTabInline('map')">Карта</button>
      <button id="tab-btn-profile" class="tabbtn" data-tab="profile" onclick="switchTabInline('profile')">Профиль</button>
    </nav>
  </div>

  <!-- Оверлей региона -->
  <div id="region-overlay" class="region-overlay" aria-hidden="true">
    <div class="bg"></div>
    <div class="panel">
      <div class="header">
        <div class="title" id="region-title"></div>
        <div class="controls">
          <!-- скелет фильтров/сортировки -->
          <button class="btn ghost" id="btn-filters" disabled>Фильтры (скоро)</button>
          <select class="select" id="sort-select" disabled>
            <option value="price-asc">Цена ↑</option>
            <option value="price-desc">Цена ↓</option>
            <option value="class">Класс</option>
            <option value="type">Тип</option>
          </select>
          <button class="btn" id="btn-back" onclick="closeRegionInline()">Назад</button>
        </div>
      </div>
      <div class="list" id="region-list"></div>
    </div>
  </div>

  <script src="app.js?v=20251029_134457_222739_220608"></script>
  <script>
  // INLINE_FALLBACK_REGIONS: если сетка пустая через 300мс — рисуем меню инлайном
  (function(){
    var r = [
      {id:'kiranomiya',name:'Kiranomiya',bg:'kiranomiya.png'},
      {id:'noroburg',name:'Noroburg',bg:'noroburg.png'},
      {id:'russet-skyline',name:'Russet Skyline',bg:'russet-skyline.png'},
      {id:'san-maris',name:'San Maris',bg:'san-maris.png'},
      {id:'solmara',name:'Solmara',bg:'solmara.png'},
      {id:'valparyn',name:'Valparyn',bg:'valparyn.png'},
      {id:'nordhaven',name:'Nordhaven',bg:'nordhaven.png'},
      {id:'nihon',name:'Nihon',bg:'nihon.png'}
    ];
    setTimeout(function(){
      var grid = document.getElementById('regions-grid');
      if(!grid) return;
      if(grid.children.length > 0) return;
      r.forEach(function(x){
        var b = document.createElement('button');
        b.className = 'region-btn';
        b.innerHTML = '<div class="name">'+x.name+'</div><small>Открыть</small>';
        b.onclick = function(){
          document.getElementById('region-title').textContent = x.name;
          document.querySelector('#region-overlay .bg').style.backgroundImage = 'url("static/regions/'+x.bg+'?v='+Date.now()+'")';
          document.getElementById('region-overlay').classList.add('active');
          document.getElementById('region-overlay').setAttribute('aria-hidden','false');
          // три одинаковых карточки (инлайн)
          var list = document.getElementById('region-list'); list.innerHTML='';
          for(var i=0;i<3;i++){
            var c = document.createElement('div'); c.className='card';
            c.innerHTML='<div><div class="title">House</div><div class="meta"><span>Класс: A</span><span>Площадь: 120 m²</span></div></div><div class="actions"><div class="price">$ 100,000</div><div class="status">Available</div><button class="btn" disabled>Buy (скоро)</button></div>';
            list.appendChild(c);
          }
        };
        grid.appendChild(b);
      });
    }, 300);
  })();
  </script>
  <script>
    // inline fallback на случай если внешние обработчики не подцепились
    function switchTabInline(name){
      try{
        document.querySelectorAll('.tab').forEach(function(t){ t.classList.remove('active'); });
        var pane = document.getElementById('tab-' + name) || document.querySelector('[data-tab-pane="'+name+'"]');
        if(pane) pane.classList.add('active');
        closeRegionInline();
      }catch(e){}
    }
    function closeRegionInline(){
      var ov = document.getElementById('region-overlay');
      if(!ov) return;
      ov.classList.remove('active');
      ov.setAttribute('aria-hidden','true');
      var bg = ov.querySelector('.bg');
      if(bg) bg.style.backgroundImage = '';
    }
  </script>
</body>
</html>




